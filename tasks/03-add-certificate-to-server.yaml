---

- name: Debug.
  ansible.builtin.debug:
    msg:
      - fortiweb_certificate_server_policy: "{{ fortiweb_certificate_server_policy | urlencode | replace('%20', '+') }}"
      - fortiweb_certificate_vdom: "{{ fortiweb_certificate_vdom }}"
      - cert_upload_name: "{{ cert_upload_name }}"
      - inter_cert_group_name: "{{ inter_cert_group_name }}"

- name: Add certificate to server policy.
  fortinet.fortiweb.fwebos_server_policy:
    action: edit
    name: "{{ fortiweb_certificate_server_policy | urlencode | replace('%20', '+') }}"
    vdom: "{{ fortiweb_certificate_vdom | default('root') }}"
    certificate: "{{ cert_upload_name }}"
    intermediate_certificate_group: "{{ inter_cert_group_name | default(omit) }}"
    comment: "Automatically generated by ndkprd.fortiweb_certificate Ansible role."
